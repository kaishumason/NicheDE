<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nicheDE">
<title>Getting Niche-DE Genes • nicheDE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Niche-DE Genes">
<meta property="og:description" content="nicheDE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nicheDE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Tutorial.html">Tutorial</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Documentation</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Kmason23/NicheDE">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting Niche-DE Genes</h1>
            
      
      
      <div class="d-none name"><code>Getting_Niche_DE_Genes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="calculating-niche-de-pvalues">Calculating Niche-DE Pvalues<a class="anchor" aria-label="anchor" href="#calculating-niche-de-pvalues"></a>
</h2>
<p>After performing niche-DE we will now calculate pvalues. The function
to calculate pvalues is called ‘get_niche_DE_pval’ and contains two
arguments.</p>
<details><summary>
Arguments
</summary><ul>
<li><p>object: A niche-DE object</p></li>
<li>
<p>pos: A logical indicating if one wants to compute interaction
level pvalues corresponding to a gene being an <span class="math inline">\((index,niche)+\)</span> gene (pos = T), or an
<span class="math inline">\((index,niche)-\)</span> gene (pos = F)</p>
</li>
</ul></details><p>In general, the user should run this function twice, one for each
value of ‘pos’</p>
<pre><code><span><span class="va">NDE_obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_niche_DE_pval.html">get_niche_DE_pval</a></span><span class="op">(</span><span class="va">NDE_obj</span>,pos <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">NDE_obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_niche_DE_pval.html">get_niche_DE_pval</a></span><span class="op">(</span><span class="va">NDE_obj</span>,pos <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
<details><summary>
Output Specifics
</summary><p>Running the above function will populate 2 fields in your niche-DE
object</p>
<ul>
<li>Niche-DE-pval-pos: Pvalues for testing if a gene is an
(index,niche)+ niche gene. This is a list with length equal to the
length of sigma. Each sublist contains 3 items.
<ul>
<li>gene-level: A list of gene level pvalues. It is a vector with length
equal to the number of genes.</li>
<li>cell-type-level: A matrix of dimension #genes by #cell types which
gives cell type level pvalues.Index (i,j) gives a pvalue corresponding
to whether gene i is a niche gene for index cell type j.</li>
<li>interaction-level: An array of dimension #cell types by #cell types
by #genes which gives interaction level pvalues. Index (i,j,k) gives a
pvalue corresponding to whether gene k is an (index cell type i, niche
cell type j)+ niche gene.</li>
</ul>
</li>
<li>Niche-DE-pval-neg: Pvalues for testing if a gene is an
(index,niche)- niche gene. This is a list with length equal to the
length of sigma. Each sublist contains 3 items.
<ul>
<li>gene-level: A list of gene level pvalues. It is a vector with length
equal to the number of genes.</li>
<li>cell-type-level: A matrix of dimension #genes by #cell types which
gives cell type level pvalues.Index (i,j) gives a pvalue corresponding
to whether gene i is a niche gene for index cell type j.</li>
<li>interaction-level: An array of dimension #cell types by #cell types
by #genes which gives interaction level pvalues. Index (i,j,k) gives a
pvalue corresponding to whether gene k is an (index cell type i, niche
cell type j)- niche gene.</li>
</ul>
</li>
</ul></details>
</div>
<div class="section level2">
<h2 id="extract-niche-de-genes-for-a-specific-indexniche-pair">Extract Niche-DE Genes For a Specific (Index,Niche) Pair<a class="anchor" aria-label="anchor" href="#extract-niche-de-genes-for-a-specific-indexniche-pair"></a>
</h2>
<p>After calculating pvalues, we can find which genes are <span class="math inline">\((index,niche)\)</span> niche genes at varying
resolutions and FDR control levels. The function to do so is called
‘get_niche_DE_genes’ and contains 6 arguments</p>
<details><summary>
Arguments
</summary><ul>
<li>object: A niche-DE object</li>
<li>resolution: The resolution at which to return genes. There are three
choices for resolution;gene level, cell type level, and interaction
level.</li>
<li>index: The index cell type of interest</li>
<li>niche: The niche cell type of interest</li>
<li>pos: A logical indicating if one wants to find interaction level
<span class="math inline">\((index,niche)+\)</span> niche genes (pos =
T), or <span class="math inline">\((index,niche)-\)</span> niche genes
(pos = F)</li>
<li>alpha: The level at which to perform the benjamini-hochberg
procedure at each resolution level<br>
</li>
</ul></details><p>Below, we find interaction level (fibroblast,tumor)+ niche genes.</p>
<pre><code><span><span class="fu"><a href="../reference/get_niche_DE_genes.html">get_niche_DE_genes</a></span><span class="op">(</span><span class="va">NDE_obj</span>,<span class="st">'interaction'</span>,index<span class="op">=</span><span class="st">'stromal'</span>,niche <span class="op">=</span> <span class="st">'tumor_epithelial'</span>,pos <span class="op">=</span> <span class="cn">T</span>,alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre>
<p>The output is a list of genes and their corresponding pvalues at the
resolution specified.</p>
<details><summary>
Interpretting Your Results
</summary><p>Assume that the ‘pos’ parameter is set to ‘True’. The interpretation
of your output will differ based on the resolution chosen.</p>
<ul>
<li><p>Resolution = gene: Genes outputted show some sign of being a
niche gene for some <span class="math inline">\((index,niche)\)</span>
pair.</p></li>
<li><p>Resolution = cell type: Genes outputted are significantly niche
up or down regulated in the index cell. The niche cell type is
unknown.</p></li>
<li>
<p>Resolution = interaction: Genes outputted are significantly
upregulated in the index cell type when in the presence of the niche
cell type. If ‘pos’ = ‘False’ then Genes outputted are significantly
downregulated in the index cell type when in the presence of the niche
cell type.</p>
</li>
</ul></details><h2 id="extract-niche-de-genes-for-a-specific-indexniche-pair-1">Pathway
Enrichement Analysis With Your Niche Genes<a class="anchor" aria-label="anchor" href="#extract-niche-de-genes-for-a-specific-indexniche-pair-1"></a>
</h2>
<p>Interaction level <span class="math inline">\((index,niche)+\)</span>
and <span class="math inline">\((index,niche)-\)</span> genes can be
input into a pathway enrichment analysis to determine what processes are
being up and downregulated in the index cell type when in the presence
of the niche cell type. Here we perform pathway enrichment analysis of
(fibroblast,tumor)+ genes.</p>
<pre><code><span><span class="co">#Load enichr package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">enrichR</span><span class="op">)</span></span>
<span><span class="co">#get fibroblast tumor niche genes</span></span>
<span><span class="va">fibro_tum_pos</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_niche_DE_genes.html">get_niche_DE_genes</a></span><span class="op">(</span><span class="va">NDE_obj</span>,<span class="st">'interaction'</span>,index<span class="op">=</span><span class="st">'stromal'</span>,niche <span class="op">=</span> <span class="st">'tumor_epithelial'</span>,pos <span class="op">=</span> <span class="cn">T</span>,alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#run pathway enrichment analysis</span></span>
<span><span class="va">fibro_tum_processes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/enrichR/man/enrichr.html" class="external-link">enrichr</a></span><span class="op">(</span><span class="va">fibro_tum_pos</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,databases <span class="op">=</span> <span class="st">'Reactome_2016'</span><span class="op">)</span></span></code></pre>

</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kaishu Mason.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
