<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nicheDE">
<title>Ligand Receptor Analysis • nicheDE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ligand Receptor Analysis">
<meta property="og:description" content="nicheDE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light" data-bs-theme="inverse"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nicheDE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Tutorial.html">Tutorial</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Documentation</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Kmason23/NicheDE">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Ligand Receptor Analysis</h1>
            
      
      
      <div class="d-none name"><code>Ligand_Receptor_Analysis.Rmd</code></div>
    </div>

    
    
<p>To see what ligand-receptor channels are driving niche signals in our
data, we developed niche-LR. Niche-LR uses the <a href="https://www.nature.com/articles/s41592-019-0667-5" class="external-link">niche-net</a>
ligand-target potential matrix to find the top <span class="math inline">\(K\)</span> downstream targets for each ligand. The
niche-DE T-statistics of these downstream genes are used to calculate
ligand activity scores. The top <span class="math inline">\(M\)</span>
ligands by ligand activity score and their corresponding receptors are
then tested to confirm expression in the tissue. Niche-LR can be
performed on spot resolution data using the function ‘niche_LR_spot’ and
on single cell resolution data using the function ‘niche_LR_cell’.
‘niche_LR_spot’ takes in 9 arguments while ‘niche_LR_cell’ has one
additional argument.</p>
<details><summary>
Arguments
</summary><ul>
<li>object: Niche-DE object</li>
<li>ligand cell: The cell type that expresses the ligand</li>
<li>receptor cell: The cell type that expresses the receptor</li>
<li>ligand_target_matrix: A matrix that measures the association between
ligands and their downstream target genes. The dimension should be
#target genes by #ligands</li>
<li>lr-mat: A matrix that matches ligands with their corresponding
receptors. This matrix should have two columns. The first will be
ligands and the second will be the corresponding receptors</li>
<li>K: The number of downstream target genes to use when calculating the
ligand activity score. Default value is 25.</li>
<li>M: The maximum number of ligands that can pass initial filtering.
Default value is 50.</li>
<li>alpha: The level at which to perform the Benjamini Hochberg
correction. Default value is 0.05.</li>
<li>truncation value: The value at which to truncate T statistics.</li>
</ul>
For ‘niche_LR_cell’, their is an additional parameter ‘alpha_2’ which
refers to the null quantile to compare observed epression to. That is
that we compare expression of the ligand and receptor to see if it is
greater than the ‘alpha_2’ percentile of gene expression over all genes
expressed in the ligand expressing or receptor expressing cell.The
Default value is 0.5 (50th percentile).
</details><p>We now perform ligand-receptor analysis to infer ligand-receptor
interactions between tumor cells (ligand expressing cell) and
fibroblasts (receptor expressing cell) on spot level data. The output
will be a list of ligands and their corresponding receptors. Note that
the ligand-target potential matrix refers to human genes.</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"niche_net_ligand_target_matrix"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ramilowski_ligand_receptor_list"</span><span class="op">)</span></span>
<span><span class="va">fibro_tumor_LR</span> <span class="op">=</span> <span class="fu"><a href="../reference/niche_LR_spot.html">niche_LR_spot</a></span><span class="op">(</span><span class="va">NDE_obj</span>,ligand_cell <span class="op">=</span> <span class="st">'tumor_epithelial'</span>,receptor_cell <span class="op">=</span> <span class="st">'stromal'</span>,</span>
<span>ligand_target_matrix <span class="op">=</span> <span class="va">niche_net_ligand_target_matrix</span>,</span>
<span>lr_mat <span class="op">=</span> <span class="va">ramilowski_ligand_receptor_list</span>,K <span class="op">=</span> <span class="fl">25</span>,M <span class="op">=</span> <span class="fl">50</span>,alpha <span class="op">=</span> <span class="fl">0.05</span>,truncation_value <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#preview output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fibro_tumor_LR</span><span class="op">)</span></span></code></pre>
<p>The output should resemble a 3 column table of ligands,their
corresponding receptors, and a list of the top 5 downstream niche-DE
genes that drive the ligand potential scoring.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kaishu Mason.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
