<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Niche-DE Genes • nicheDE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Niche-DE Genes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nicheDE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/Tutorial.html">Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Documentation</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Kmason23/NicheDE"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Niche-DE Genes</h1>
            
      

      <div class="d-none name"><code>Getting_Niche_DE_Genes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="extract-niche-de-genes-for-a-specific-indexniche-pair">Extract Niche-DE Genes For a Specific (Index,Niche) Pair<a class="anchor" aria-label="anchor" href="#extract-niche-de-genes-for-a-specific-indexniche-pair"></a>
</h2>
<p>After calculating pvalues, we can find which genes are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>,</mo><mi>n</mi><mi>i</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(index,niche)</annotation></semantics></math>
niche genes at varying resolutions and FDR control levels. The function
to do so is called ‘get_niche_DE_genes’ and contains 6 arguments</p>
<details><summary>
Arguments
</summary><ul>
<li>object: A niche-DE object</li>
<li>test.level: The resolution at which to return genes. There are three
choices for test.level;gene level (‘G’), cell type level (‘CT’), and
interaction level (‘I’).</li>
<li>index: The index cell type of interest</li>
<li>niche: The niche cell type of interest</li>
<li>positive: Boolean of whether to return positive/upregulated niche-DE
genes (True) or negative/downweighted niche-DE genes (False). Default
value is True.</li>
<li>alpha: The level at which to perform the benjamini-hochberg
procedure at each resolution level. Default value is 0.05.<br>
</li>
</ul></details><p>Below, we find interaction level (fibroblast,tumor)+ niche genes.</p>
<pre><code><span><span class="va">DE_genes</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_niche_DE_genes.html">get_niche_DE_genes</a></span><span class="op">(</span><span class="va">NDE_obj</span>,<span class="st">'I'</span>,index<span class="op">=</span><span class="st">'stromal'</span>,niche <span class="op">=</span> <span class="st">'tumor_epithelial'</span>,positive <span class="op">=</span> <span class="cn">T</span>,alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DE_genes</span><span class="op">)</span></span></code></pre>
<p>The output is a matrix of genes and their corresponding pvalues at
the resolution specified.</p>
<details><summary>
Interpretting Your Results
</summary><p>Assume that the direction parameter is set to ‘positive’. The
interpretation of your output will differ based on the resolution
chosen.</p>
<ul>
<li><p>Test.level = gene: Genes outputted show some sign of being a
niche gene for some
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>,</mo><mi>n</mi><mi>i</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(index,niche)</annotation></semantics></math>
pair.</p></li>
<li><p>Test.level = cell type: Genes outputted are significantly niche
up or down regulated in the index cell. The niche cell type is
unknown.</p></li>
<li>
<p>Test.level = interaction: Genes outputted are significantly
upregulated in the index cell type when in the presence of the niche
cell type. If ‘pos’ = ‘False’ then Genes outputted are significantly
downregulated in the index cell type when in the presence of the niche
cell type.</p>
</li>
</ul></details><h2 id="extract-niche-de-genes-for-a-specific-indexniche-pair-1">Pathway
Enrichement Analysis With Your Niche Genes<a class="anchor" aria-label="anchor" href="#extract-niche-de-genes-for-a-specific-indexniche-pair-1"></a>
</h2>
<p>Interaction level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>,</mo><mi>n</mi><mi>i</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">(index,niche)+</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>,</mo><mi>n</mi><mi>i</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">(index,niche)-</annotation></semantics></math>
genes can be input into a pathway enrichment analysis to determine what
processes are being up and downregulated in the index cell type when in
the presence of the niche cell type. Here we perform pathway enrichment
analysis of (fibroblast,tumor)+ genes using the enrichR package.</p>
<pre><code><span><span class="co">#Load enichr package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">enrichR</span><span class="op">)</span></span>
<span><span class="co">#get fibroblast tumor niche genes</span></span>
<span><span class="va">fibro_tum_pos</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_niche_DE_genes.html">get_niche_DE_genes</a></span><span class="op">(</span><span class="va">NDE_obj</span>,<span class="st">'I'</span>,index<span class="op">=</span><span class="st">'stromal'</span>,niche <span class="op">=</span> <span class="st">'tumor_epithelial'</span>,positive <span class="op">=</span> <span class="cn">T</span>,alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#run pathway enrichment analysis</span></span>
<span><span class="va">fibro_tum_processes</span> <span class="op">=</span> <span class="fu">enrichr</span><span class="op">(</span><span class="va">fibro_tum_pos</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,databases <span class="op">=</span> <span class="st">'Reactome_2016'</span><span class="op">)</span></span>
<span><span class="co">#View processes in a table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">fibro_tum_processes</span><span class="op">$</span><span class="va">Reactome_2016</span><span class="op">)</span></span></code></pre>

</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kaishu Mason.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
